# EliteScore API — v2 (Extract: Parser & CV Evaluation)

Base URL
--------
All endpoints are prefixed with `/v2/parser`.

Content Types
-------------
- Request: multipart/form-data (for file uploads)
- Response: application/json

==================================================
# Resource Path: /v2/parser

## GET /v2/parser/health
Summary: Service health check for the main OpenAI CV evaluation pipeline.
Auth: none
Response (200 OK):
{
  "status": "ok",
  "openai_key": boolean,
  "primary_model": string,
  "escalation_model": string,
  "auto_escalate": boolean,
  "min_confidence": number,
  "max_mb": number
}

--------------------------------------------------
## GET /v2/parser/acc/health
Summary: Service health check for the ACC (secondary) OpenAI pipeline.
Auth: none
Response (200 OK):
{
  "status": "ok",
  "openai_key": boolean,
  "primary_model": string,
  "auto_escalate": string,
  "min_confidence": string,
  "max_mb": number
}

--------------------------------------------------
## POST /v2/parser/resume/score
Summary: Upload a CV/Resume file for AI evaluation (synchronous scoring).
Auth: none
Consumes: multipart/form-data
Form Data:
- file: UploadFile (.pdf, .doc, .docx, ≤10 MB)
Response (200 OK):
{
  "score": number,               // overall score (0–100)
  "parsed": {
    "name": string,
    "email": string,
    "skills": [string],
    "overall_score": number,
    "components": {
      "education": number,
      "experience": number,
      "skills": number,
      "ai_signal": number,
      "projects": number
    },
    "weights": {
      "education": number,
      "experience": number,
      "skills": number,
      "ai_signal": number,
      "projects": number
    },
    "confidence": number,
    "explanation": {
      "highlights": [string],
      "top_archetype_matches": [
        { "name": string, "match_pct": number }
      ],
      "notes": {
        "strengths": [string],
        "weaknesses": [string]
      }
    }
  }
}

## POST /v2/parser/resume/score 
Summary: Same as the previous one , scores the resume score inside the DB.
--------------------------------------------------
## POST /v2/parser/resume/acc/score_async
Summary: Start asynchronous CV evaluation on the ACC model (background job).
Auth: required
Consumes: multipart/form-data
Form Data:
- file: UploadFile (.pdf, .doc, .docx)
Response (202 Accepted):
{
  "proc_id": string,
  "status": "queued"
}

Notes:
- Returns immediately with a process ID.
- Use `/resume/task_status/{task_id}` and `/resume/result/{task_id}` to track progress and fetch results.

--------------------------------------------------
## GET /v2/parser/resume/task_status/{task_id}
Summary: Poll job status for an asynchronous ACC evaluation.
Auth: required
Path Params:
- task_id (string) — process ID
Response (200 OK):
{
  "proc_id": string,
  "status": "queued"|"running"|"done"|"failed",
  "stage": string,
  "progress": number,
  "created_at": int,
  "started_at": int | null,
  "finished_at": int | null,
  "acc": boolean,
  "filename": string
}
Errors:
- 401 Unauthorized
- 403 Forbidden — not owner of process ID
- 404 Not Found — invalid process ID

--------------------------------------------------
## GET /v2/parser/resume/result/{task_id}
Summary: Retrieve the final result of a completed ACC evaluation job.
Auth: required
Path Params:
- task_id (string)
Response (200 OK):
{
  "score": number,
  "parsed": { ...same structure as /resume/score... }
}
Errors:
- 401 Unauthorized
- 404 Not Found — result not ready or process failed

--------------------------------------------------
## POST /v2/parser/resume/cv
Summary: Extract structured LinkedIn-style profile data from a CV or resume.
Auth: none
Consumes: multipart/form-data
Form Data:
- file: UploadFile (.pdf, .doc, .docx)
Response (200 OK):
{
  "profile": {
    "basics": {
      "full_name": string,
      "headline": string,
      "email": string,
      "phone": string,
      "location": string,
      "summary": string,
      "urls": {
        "linkedin": string,
        "github": string,
        "portfolio": string,
        "website": string
      }
    },
    "experience": [
      {
        "title": string,
        "company": string,
        "employment_type": string,
        "location": string,
        "start_date": string,
        "end_date": string | null,
        "is_current": boolean,
        "description": string,
        "achievements": [string]
      }
    ],
    "education": [
      {
        "school": string,
        "degree": string,
        "field_of_study": string,
        "start_date": string,
        "end_date": string | null,
        "grade": string,
        "activities": string,
        "description": string
      }
    ],
    "projects": [
      {
        "name": string,
        "role": string,
        "start_date": string,
        "end_date": string | null,
        "url": string,
        "description": string,
        "highlights": [string],
        "tech": [string]
      }
    ],
    "skills": [string],
    "certifications": [
      {
        "name": string,
        "issuer": string,
        "issue_date": string,
        "credential_id": string,
        "credential_url": string
      }
    ],
    "languages": [
      { "name": string, "proficiency": string }
    ],
    "publications": [
      {
        "title": string,
        "publisher": string,
        "date": string,
        "url": string,
        "summary": string
      }
    ],
    "honors_awards": [
      {
        "title": string,
        "issuer": string,
        "date": string,
        "description": string
      }
    ],
    "volunteer": [
      {
        "role": string,
        "organization": string,
        "cause": string,
        "start_date": string,
        "end_date": string | null,
        "description": string
      }
    ]
  }
}

==================================================

Examples — cURL
---------------

# Health check
curl -X GET "$BASE/v2/parser/health"

# Score CV
curl -X POST "$BASE/v2/parser/resume/score" \
  -F "file=@cv.pdf"

# Start async ACC scoring
curl -X POST "$BASE/v2/parser/resume/acc/score_async" \
  -H "Authorization: Bearer <token>" \
  -F "file=@cv.pdf"

# Check job status
curl -X GET "$BASE/v2/parser/resume/task_status/<proc_id>" \
  -H "Authorization: Bearer <token>"

# Get final result
curl -X GET "$BASE/v2/parser/resume/result/<proc_id>" \
  -H "Authorization: Bearer <token>"

# Parse CV to LinkedIn-style profile
curl -X POST "$BASE/v2/parser/resume/cv" \
  -F "file=@cv.pdf"